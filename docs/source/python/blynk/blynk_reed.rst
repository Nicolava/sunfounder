
ドア・ウィンドウセンサー
========================

外出先で「家のドアや窓は閉まっているのだろうか？」と不安に思ったことはありませんか？

このプロジェクトでは、リードスイッチと磁石を使用して、ドアや窓の開閉状態を感知するセンサーを作成します。

このセンサーと磁石をドアや窓の両側に取り付けることで、スマートフォンのBlynkアプリを使って、ドアや窓がしっかり閉まっているかどうかを確認できます。

.. note:: このプロジェクトを始める前に、 :ref:`bk_start` を完了させることをお勧めします。これにより、Blynkについてより深く理解できます。

**必要なコンポーネント**

このプロジェクトには以下の部品が必要です。

一式をまとめて購入するのが便利です。以下がリンクです：

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - 名前
        - このキットのアイテム
        - リンク
    *   - Raphael Kit
        - 337
        - |link_Raphael_kit|

個別に購入する場合は、以下のリンクからどうぞ。

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - 部品説明
        - 購入リンク
    *   - :ref:`GPIO拡張ボード`
        - |link_gpio_board_buy|
    *   - :ref:`ブレッドボード`
        - |link_breadboard_buy|
    *   - :ref:`ジャンパーワイヤー`
        - |link_wires_buy|
    *   - :ref:`リードスイッチモジュール`
        - |link_reed_switch_buy|


**1. 配線**

.. image:: img/wiring_blynk_reed.png

**2. データストリームの作成**

1. 右上隅のメニューアイコンをクリックし、ダッシュボードの編集を選びます。

    .. image:: img/sp220913_180231.png

2. データストリームページに移動し、新しいデータストリームを作成します。

    .. image:: img/sp220914_165911.png

3. バーチャルピンV4を作成します。

    .. image:: img/sp220914_170113.png

#. すべての設定が完了したら、右上にある「保存して適用」をクリックします。

    .. image:: img/sp220913_182300.png

**3. コードの実行**

1. コードを編集します。

.. raw:: html

   <run></run>

.. code-block:: 

    cd ~/blynk-raspberrypi-python
    sudo nano blynk_reed.py

2. 以下の行を見つけて、 ``BLYNK_AUTH_TOKEN`` を貼り付けます。

.. code-block:: python

    BLYNK_AUTH = 'YourAuthToken'

3. コードを実行します。

.. raw:: html

   <run></run>

.. code-block:: 

    sudo python3 blynk_reed.py

**4. Blynkアプリを起動**

.. note::

    BlynkのWebページ上でのみデータストリームを作成できますので、モバイルデバイス上のBlynkでウィジェットを作成するためのチュートリアルに進む前に、Webでデータストリームを作成する必要があります。

#. モバイルデバイスでGoogle PlayまたはAPP Storeを開き、「Blynk IoT」（Blynk（レガシー）ではない）と検索してダウンロードします。
#. アプリを開いてログインします。このアカウントはWebクライアントで使用したものと同じでなければなりません。
#. その後、 **Dashboard** （お持ちでない場合は作成してください）にアクセスすると、モバイル用とウェブ用の **Dashboard** がそれぞれ独立していることがわかります。

    .. image:: img/APP_1.jpg

#. **Edit** アイコンをクリックします。
#. 空白エリアをクリックします。
#. **LED** ウィジェットを選択します。

    .. image:: img/APP_2.jpg

#. 空白エリアに **LED** ウィジェットが表示されますので、それをクリックします。
#. **LED** の設定画面が表示されるので、Webページで設定した **V4** データストリームを選択します。
#. **Dashboard** に戻ると、 **LED** ウィジェットが色で埋まっていれば、ドアや窓が開いています；色で埋まっていなければ、ドアや窓は閉まっています。

    .. image:: img/APP_3.jpg

