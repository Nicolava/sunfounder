 
.. _3.1.2_py:

3.1.2 Module Vidéo
=====================

Introduction
-----------------

En plus de prendre des photos, le module caméra peut également être utilisé pour enregistrer des vidéos.

Composants Nécessaires
--------------------------------

Dans ce projet, nous avons besoin des composants suivants. 

.. image:: ../img/photo1.png
  :width: 800

Il est définitivement pratique d'acheter un kit complet, voici le lien : 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nom	
        - ÉLÉMENTS DANS CE KIT
        - LIEN
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Vous pouvez également les acheter séparément avec les liens ci-dessous.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCTION DES COMPOSANTS
        - LIEN D'ACHAT

    *   - :ref:`cpn_camera_module`
        - |link_camera_buy|

Procédures Expérimentales
------------------------------

**Étape 1 :** Accédez au bureau de la Raspberry Pi. Vous pouvez avoir besoin d'un écran pour une meilleure expérience, consultez : `Connectez votre Raspberry Pi <https://projects.raspberrypi.org/en/projects/raspberry-pi-setting-up/3>`_. Ou accédez à distance au bureau Raspberry Pi, pour un tutoriel détaillé, veuillez consulter : :ref:`remote_desktop`.

**Étape 2 :** Vérifiez si la caméra est activée. Pour les instructions, veuillez consulter : :ref:`enable_camera`.

**Étape 3 :** Ouvrez un Terminal et accédez au dossier du code.


.. code-block::

    cd ~/raphael-kit/python/

**Étape 4 :** Exécutez le code.


.. code-block::

    sudo python3 3.1.2_VideoModule.py

Exécutez le code pour commencer l'enregistrement. Appuyez sur ``Ctrl+C`` pour terminer l'enregistrement. Nommez la vidéo ``my_video.h264`` et stockez-la dans le répertoire ``~``.

.. note::

    Vous pouvez également ouvrir ``3.1.2_PhotographModule.py`` dans le chemin ``~/raphael-kit/python/`` avec un IDE Python, cliquer sur le bouton Exécuter pour lancer le code, et arrêter le code avec le bouton Arrêter.

Si vous souhaitez envoyer des photos sur votre PC, veuillez consulter : :ref:`filezilla`.


**Code**

.. code-block:: python

    from picamera import PiCamera
    import os
    user = os.getlogin()
    user_home = os.path.expanduser(f'~{user}')


    camera = PiCamera()
    
    def setup():
        camera.start_preview(alpha=200)
    
    def main():
        camera.start_recording(f'{user_home}/my_video.h264')
        while True:
            pass    
    
    def destroy():
        camera.stop_recording()
        camera.stop_preview()
    
    if __name__ == '__main__':
        setup()
        try:
            main()
        except KeyboardInterrupt:
            destroy()

**Explication du Code**

.. code-block:: python

    start_recording(output, format=None, resize=None, splitter_port=1, **options)

Commencez l'enregistrement vidéo à partir de la caméra, en le stockant dans ``output``.

.. code-block:: python

    camera.stop_recording()

Arrêtez l'enregistrement.

