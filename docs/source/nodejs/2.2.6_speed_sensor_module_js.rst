 
.. _2.2.6_js:

2.2.6 Module de Capteur de Vitesse
======================================

Introduction
---------------

Dans ce projet, nous allons apprendre à utiliser le module de capteur de vitesse. Un module de capteur de vitesse est un type de tachymètre utilisé pour mesurer la vitesse d'un objet en rotation comme un moteur.

Composants Nécessaires
-------------------------

Dans ce projet, nous avons besoin des composants suivants. 

.. image:: ../img/2.2.6component.png
    :width: 700
    :align: center

Il est certainement pratique d'acheter un kit complet, voici le lien : 

.. list-table::
    :widths: 20 20 20
    :header-rows: 1

    *   - Nom	
        - ÉLÉMENTS DANS CE KIT
        - LIEN
    *   - Kit Raphael
        - 337
        - |link_Raphael_kit|

Vous pouvez également les acheter séparément via les liens ci-dessous.

.. list-table::
    :widths: 30 20
    :header-rows: 1

    *   - INTRODUCTION DES COMPOSANTS
        - LIEN D'ACHAT

    *   - :ref:`cpn_gpio_extension_board`
        - |link_gpio_board_buy|
    *   - :ref:`cpn_breadboard`
        - |link_breadboard_buy|
    *   - :ref:`cpn_wires`
        - |link_wires_buy|
    *   - :ref:`cpn_resistor`
        - |link_resistor_buy|
    *   - :ref:`cpn_led`
        - |link_led_buy|
    *   - :ref:`cpn_speed_sensor`
        - \-

Schéma de Circuit
-----------------

.. image:: ../img/2.2.6circuit.png
    :width: 400
    :align: center

Procédures Expérimentales
-----------------------------

**Étape 1 :** Construire le circuit.

.. image:: ../img/2.2.6fritzing.png
    :width: 700
    :align: center

**Étape 2 :** Aller dans le dossier du code.

.. raw:: html

   <run></run>

.. code-block::
    
    cd ~/raphael-kit/nodejs/

**Étape 3 :** Exécuter le code.

.. raw:: html

   <run></run>

.. code-block::

    sudo node speed_sensor_module.js

Après l'exécution du code, la LED verte s'allumera. Si vous placez un obstacle dans l'écart du 
module de capteur de vitesse, "light blocked" sera imprimé à l'écran et la LED rouge s'allumera. 
Retirez l'obstacle et la LED verte s'allumera à nouveau.

**Code**

.. code-block:: js

    const Gpio = require('pigpio').Gpio;

    const Rpin = new Gpio(22, { mode: Gpio.OUTPUT });
    const Gpin = new Gpio(27, { mode: Gpio.OUTPUT });

    const speedPin = new Gpio(17, {
        mode: Gpio.INPUT,
        pullUpDown: Gpio.PUD_DOWN,     
        edge: Gpio.EITHER_EDGE        
    });

    speedPin.on('interrupt', (level) => {
        if (level) {
            console.log("Light was blocked");
        }
        Rpin.digitalWrite(level);
        Gpin.digitalWrite(!level);
    });

    process.on('SIGINT', function () {
        Rpin.digitalWrite(0);
        Gpin.digitalWrite(0);
        process.exit();
    });

**Explication du Code**

Le code de cet exemple est presque identique à :ref:`2.1.5_js`, donc il n'est pas nécessaire de le répéter.



Photo du Phénomène
------------------

.. image:: ../img/2.2.6photo_interrrupter.JPG
   :width: 500
   :align: center

